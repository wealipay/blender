{"version":3,"sources":["../../../src/server/mcp/get-or-create-mcp-server.ts"],"sourcesContent":["import { McpServer } from 'next/dist/compiled/@modelcontextprotocol/sdk/server/mcp'\nimport { registerGetProjectMetadataTool } from './tools/get-project-metadata'\nimport { registerGetErrorsTool } from './tools/get-errors'\nimport { registerGetPageMetadataTool } from './tools/get-page-metadata'\nimport { registerGetLogsTool } from './tools/get-logs'\nimport { registerGetActionByIdTool } from './tools/get-server-action-by-id'\nimport type { HmrMessageSentToBrowser } from '../dev/hot-reloader-types'\n\nexport interface McpServerOptions {\n  projectPath: string\n  distDir: string\n  sendHmrMessage: (message: HmrMessageSentToBrowser) => void\n  getActiveConnectionCount: () => number\n  getDevServerUrl: () => string | undefined\n}\n\nlet mcpServer: McpServer | undefined\n\nexport const getOrCreateMcpServer = (options: McpServerOptions) => {\n  if (mcpServer) {\n    return mcpServer\n  }\n\n  mcpServer = new McpServer({\n    name: 'Next.js MCP Server',\n    version: '0.1.0',\n  })\n\n  registerGetProjectMetadataTool(\n    mcpServer,\n    options.projectPath,\n    options.getDevServerUrl\n  )\n  registerGetErrorsTool(\n    mcpServer,\n    options.sendHmrMessage,\n    options.getActiveConnectionCount\n  )\n  registerGetPageMetadataTool(\n    mcpServer,\n    options.sendHmrMessage,\n    options.getActiveConnectionCount\n  )\n  registerGetLogsTool(mcpServer, options.distDir)\n  registerGetActionByIdTool(mcpServer, options.distDir)\n\n  return mcpServer\n}\n"],"names":["McpServer","registerGetProjectMetadataTool","registerGetErrorsTool","registerGetPageMetadataTool","registerGetLogsTool","registerGetActionByIdTool","mcpServer","getOrCreateMcpServer","options","name","version","projectPath","getDevServerUrl","sendHmrMessage","getActiveConnectionCount","distDir"],"mappings":"AAAA,SAASA,SAAS,QAAQ,0DAAyD;AACnF,SAASC,8BAA8B,QAAQ,+BAA8B;AAC7E,SAASC,qBAAqB,QAAQ,qBAAoB;AAC1D,SAASC,2BAA2B,QAAQ,4BAA2B;AACvE,SAASC,mBAAmB,QAAQ,mBAAkB;AACtD,SAASC,yBAAyB,QAAQ,kCAAiC;AAW3E,IAAIC;AAEJ,OAAO,MAAMC,uBAAuB,CAACC;IACnC,IAAIF,WAAW;QACb,OAAOA;IACT;IAEAA,YAAY,IAAIN,UAAU;QACxBS,MAAM;QACNC,SAAS;IACX;IAEAT,+BACEK,WACAE,QAAQG,WAAW,EACnBH,QAAQI,eAAe;IAEzBV,sBACEI,WACAE,QAAQK,cAAc,EACtBL,QAAQM,wBAAwB;IAElCX,4BACEG,WACAE,QAAQK,cAAc,EACtBL,QAAQM,wBAAwB;IAElCV,oBAAoBE,WAAWE,QAAQO,OAAO;IAC9CV,0BAA0BC,WAAWE,QAAQO,OAAO;IAEpD,OAAOT;AACT,EAAC","ignoreList":[0]}